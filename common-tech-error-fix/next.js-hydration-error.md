# Next.js ржП Hydration Error

ЁЯУНNext.js ржП Hydration Error тАФ ржХрзЗржи рж╣ржпрж╝ ржПржмржВ ржХрзАржнрж╛ржмрзЗ рж╕ржорж╛ржзрж╛ржи ржХрж░ржмрзЗржи?\
Next.js ржП ржЖржорж░рж╛ ржпрж╛рж░рж╛ ржХрж╛ржЬ ржХрж░рж┐ рждрж╛рж░рж╛ ржкрзНрж░рж╛ржпрж╝ржЗ ржПржЗ ржПрж░рж░ржЯрж╛рж░ рж╕ржорзНржорзБржЦрзАржи рж╣ржЗ:\
\
тЬЕ ржПрж░ ржорж╛ржирзЗ рж╣рж▓рзЛ, рж╕рж╛рж░рзНржнрж╛рж░ ржерзЗржХрзЗ ржЖрж╕рж╛ HTML ржПржмржВ ржХрзНрж▓рж╛ржпрж╝рзЗржирзНржЯрзЗрж░ React render ржарж┐ржХржорждрзЛ ржорж┐рж▓рзЗ ржпрж╛ржЪрзНржЫрзЗ ржирж╛ред\
\
ржЪрж▓рзБржи ржзрж╛ржкрзЗ ржзрж╛ржкрзЗ ржжрзЗржЦрж┐ ржХрзЗржи рж╣ржпрж╝ ржПржмржВ ржХрзАржнрж╛ржмрзЗ рж╕ржорж╛ржзрж╛ржи ржХрж░ржмрзЗржи, ржпрзЗржи ржнржмрж┐рж╖рзНржпрждрзЗ ржЖрж░ ржПржЗ рж╕ржорж╕рзНржпрж╛ ржирж╛ рж╣ржпрж╝ред\
\
ЁЯУНржХрзЗржи Hydration Error рж╣ржпрж╝?\
рззя╕П. Render-ржП Dynamic Values ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛\
ржпрзЗржоржи:\
\<div>{[Date.now](http://date.now/)()}\</div>\
\<div>{Math.random()}\</div>\
тЮбржкрзНрж░рждрж┐ржмрж╛рж░ ржирждрзБржи ржорж╛ржи ржЖрж╕рж╛ржпрж╝ server & client ржПрж░ HTML mismatch рж╣ржпрж╝ред\
\
рзи. Render-ржП typeof window logic ржмрзНржпржмрж╣рж╛рж░\
ржпрзЗржоржи:\
if (typeof window !== 'undefined') {\
// ржХрзЛржирзЛ DOM logic\
}\
тЮб рж╕рж╛рж░рзНржнрж╛рж░рзЗ window ржерж╛ржХрзЗ ржирж╛, рждрж╛ржЗ server-side ржПржмржВ client-side ржПрж░ ржоржзрзНржпрзЗ ржкрж╛рж░рзНржержХрзНржп рждрзИрж░рж┐ рж╣ржпрж╝ред\
\
рзйя╕П. Client-specific data ржмрзНржпржмрж╣рж╛рж░\
ржпрзЗржоржи:\
const theme = localStorage.getItem("theme");\
тЮб рж╕рж╛рж░рзНржнрж╛рж░рзЗ localStorage ржирзЗржЗ, рждрж╛ржЗ рж╕ржорж╕рзНржпрж╛ рж╣ржпрж╝ред\
\
рзкя╕П. User locale-based date/time format\
ржпрзЗржоржи:\
\
new Date().toLocaleDateString()\
тЮбUser ржПрж░ ржмрзНрж░рж╛ржЙржЬрж╛рж░рзЗрж░ locale ржЕржирзБржпрж╛ржпрж╝рзА рждрж╛рж░рж┐ржЦ ржЖрж▓рж╛ржжрж╛ рж╣рждрзЗ ржкрж╛рж░рзЗред\
\
рзля╕П. Invalid HTML nesting\
ржпрзЗржоржи:\
\<div>\<p>\</div>\</p>\
тЮбя╕П ржнрзБрж▓ nesting ржПрж░ ржХрж╛рж░ржгрзЗ React hydrate ржХрж░рждрзЗ ржЧрж┐ржпрж╝рзЗ mismatch ржкрж╛ржпрж╝ред\
\
рзмя╕П. Fonts ржмрж╛ CSS class mismatch\
Custom font ржмрж╛ CSS module ржПрж░ dynamic class name рж╕рж╛рж░рзНржнрж╛рж░рзЗ ржПржХрж░ржХржо, ржХрзНрж▓рж╛ржпрж╝рзЗржирзНржЯрзЗ ржЕржирзНржпрж░ржХржо рж╣рждрзЗ ржкрж╛рж░рзЗред\
\
тЬЕрж╕ржорж╛ржзрж╛ржи (How to Fix)\
рззя╕П. Dynamic values рж╕рж░рж┐ржпрж╝рзЗ ржлрзЗрж▓рзБржи ржмрж╛ useEffect ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржи\
тЭМ \<div>{[Date.now](http://date.now/)()}\</div>\
\
тЬЕ const \[now, setNow] = useState(null);\
\
useEffect(() => {\
setNow([Date.now](http://date.now/)());\
}, \[]);\
\
if (!now) return null;\
\
return \<div>{now}\</div>;\
рзия╕П. typeof window logic рж╕ржм рж╕ржоржпрж╝ useEffect ржП рж░рж╛ржЦрзБржи\
useEffect(() => {\
if (typeof window !== 'undefined') {\
// client-side logic\
}\
}, \[]);\
рзйя╕П. Client-specific data fetch ржХрж░рж▓рзЗ, рждрж╛ useEffect ржП ржирж┐ржи\
const \[theme, setTheme] = useState("light");\
\
useEffect(() => {\
const localTheme = localStorage.getItem("theme");\
setTheme(localTheme || "light");\
}, \[]);\
рзкя╕П. Client-only component рж╣рж▓рзЗ SSR ржмржирзНржз ржХрж░рзБржи\
import dynamic from 'next/dynamic';\
const ClientComponent = dynamic(() => import('./ClientComponent'), { ssr: false });\
рзля╕П. HTML nesting рж╕ржмрж╕ржоржпрж╝ рж╕ржарж┐ржХ рж░рж╛ржЦрзБржи\
тЭО \<div>\<p>\</div>\</p>\
тЬЕрз╖ \<div>\<p>\</p>\</div>\
рзмя╕П. Fonts ржУ CSS module ржПрж░ configuration рж╕ржарж┐ржХржнрж╛ржмрзЗ ржХрж░рзБржи\
Next.js ржП @next/font ржмрж╛ ржЕржирзНржпрж╛ржирзНржп рж╕ржарж┐ржХ ржкржжрзНржзрждрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржиред\
\
Dynamic class name ржмрж╛ font mismatch ржпрзЗржи ржирж╛ рж╣ржпрж╝ рждрж╛ ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рзБржиред\
\
ЁЯУНржнржмрж┐рж╖рзНржпрждрзЗ ржпрж╛рждрзЗ Hydration Error ржирж╛ рж╣ржпрж╝, ржХрзА ржХрзА ржЦрзЗржпрж╝рж╛рж▓ рж░рж╛ржЦржмрзЗржи?\
тЬЕ Render-ржП ржХржЦржирзЛ random ржмрж╛ dynamic value ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗржи ржирж╛ред\
тЬЕ Client-only logic рж╕ржм рж╕ржоржпрж╝ useEffect ржП рж░рж╛ржЦрзБржиред\
тЬЕ Client-specific data server-side ржП ржЖржирзБржи ржмрж╛ useEffect ржП ржирж┐ржиред\
тЬЕ HTML nesting ржарж┐ржХ рж░рж╛ржЦрзБржиред\
тЬЕ Fonts ржУ CSS ржПрж░ config ржарж┐ржХ рж░рж╛ржЦрзБржиред\
тЬЕ ржжрж░ржХрж╛рж░ рж╣рж▓рзЗ SSR ржмржирзНржз ржХрж░рзБржиред\
\
ЁЯУН рж╢рзЗрж╖ ржХржерж╛\
Hydration error ржЖржорж╛ржжрзЗрж░ ржкрзНрж░ржЬрзЗржХрзНржЯрзЗрж░ UI ржХрзЗ ржнрж╛ржЩрж╛ ржПржмржВ ржЗржЙржЬрж╛рж░рзЗрж░ ржЬржирзНржп ржЦрж╛рж░рж╛ржк ржЕржнрж┐ржЬрзНржЮрждрж╛ ржжрзЗржпрж╝ред\
рж╕ржарж┐ржХ ржирж┐ржпрж╝ржо ржорзЗржирзЗ ржХрзЛржб рж▓рж┐ржЦрж▓рзЗ ржЦрзБржм рж╕рж╣ржЬрзЗржЗ ржПржбрж╝рж╛ржирзЛ ржпрж╛ржпрж╝ред
